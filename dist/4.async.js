(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{Tcyh:function(e,t,a){"use strict";a.r(t);a("DYRE");var n=a("zeV3"),l=(a("g9YV"),a("wCAj")),r=(a("14J3"),a("BMrR")),c=(a("R9oj"),a("ECub")),i=(a("jCWc"),a("kPKH")),s=(a("IzEo"),a("bx4M")),o=(a("MXD1"),a("CFYs")),d=a("d6i3"),m=a.n(d),u=a("1l/V"),p=a.n(u),v=(a("/xke"),a("TeRw")),E=a("p0pE"),x=a.n(E),b=a("qIgq"),g=a.n(b),_=(a("fu2T"),a("gK9i")),f=(a("5NDa"),a("5rEg")),y=(a("LvDl"),a("Ty5D")),h=a("q1tI"),w=a.n(h),S=a("bXgo"),k=a("rfcs"),j=(a("gVQ5"),a("vDqi")),z=a.n(j),O=a("m5wo"),N=a.n(O),T=(f["a"].Search,_["a"].Panel),C=[{title:"\u4efb\u52a1id",dataIndex:"task_id"},{title:"\u4efb\u52a1\u540d\u79f0",dataIndex:"task_name"},{title:"\u8bbe\u5907id",dataIndex:"device_id"},{title:"\u8bbe\u5907\u540d\u79f0",dataIndex:"device_name"}],q=()=>{var e;Object(h["useEffect"])(()=>{ne()},[]);var t=Object(h["useState"])([]),a=g()(t,2),d=a[0],u=a[1],E=Object(h["useState"])([]),b=g()(E,2),f=(b[0],b[1]),y=Object(h["useState"])([]),j=g()(y,2),O=j[0],q=j[1],A=Object(h["useState"])([]),D=g()(A,2),I=D[0],R=D[1],J=Object(h["useState"])([]),M=g()(J,2),K=M[0],W=M[1],L=Object(h["useState"])(!0),V=g()(L,2),Y=V[0],B=V[1],F=Object(h["useState"])(!1),P=g()(F,2),X=P[0],G=P[1],H=Object(h["useState"])({}),Q=g()(H,2),U=Q[0],Z=Q[1];Object(h["useEffect"])(()=>{var e=d.filter(e=>"\u5728\u7ebf"===e.tags[0]),t=e.map(e=>{var t=new WebSocket("ws://localhost:8000/api/internet/status?internet_id=".concat(e.id));return t.onmessage=(t=>{var a=JSON.parse(t.data);Z(t=>x()({},t,{[e.id]:a}))}),t});return()=>{t.forEach(e=>e.close())}},[d]),console.log("cqm",U),console.log("cqm",null===(e=U[7])||void 0===e?void 0:e.cup_used);var $=e=>{v["a"].info({message:"\u8bf7\u9009\u62e9\u4efb\u52a1",placement:e})},ee=e=>{v["a"].info({message:"\u8bf7\u9009\u62e9\u8bbe\u5907",placement:e})},te=function(){var e=p()(m.a.mark(function e(){var t,a;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={tasks:I,devices:K},e.prev=1,e.next=4,z.a.post("/api/distribute",t);case 4:a=e.sent,q(a.data.best_allocation),console.log("\u63d0\u4ea4\u6210\u529f:",a.data),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.error("\u63d0\u4ea4\u5931\u8d25:",e.t0);case 12:case"end":return e.stop()}},e,null,[[1,9]])}));return function(){return e.apply(this,arguments)}}(),ae=()=>{0===I.length&&$("topRight"),0===K.length&&ee("topRight"),0!==K.length&&0!==I.length&&(te(),B(!1),setTimeout(()=>{G(!0)},1e3))},ne=function(){var e=p()(m.a.mark(function e(){var t,a;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.a.get("/api/internet");case 3:return t=e.sent,e.next=6,z.a.get("/api/task",{params:{page_num:1,page_size:100}});case 6:a=e.sent,f(a.data.data["task_list"]),u(t.data.data),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.error(e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}();return w.a.createElement(n["b"],{direction:"vertical"},w.a.createElement(_["a"],{collapsible:"header",defaultActiveKey:["1"],ghost:!0},w.a.createElement(T,{header:w.a.createElement("div",{style:{fontSize:"20px",fontWeight:"bold"}},"\u8bbe\u5907\u76d1\u63a7"),key:"1"},w.a.createElement(r["a"],{gutter:[16,16]},d.map((e,t)=>{var a,n,l,r;return"\u5728\u7ebf"===e.tags[0]&&w.a.createElement("div",{style:{justifyContent:"center"}},w.a.createElement(i["a"],{key:t,span:10},w.a.createElement("div",{className:N.a.card},w.a.createElement(s["a"],{size:"small",title:w.a.createElement("span",{style:{fontSize:"20px"}},e.name),extra:w.a.createElement("a",{href:"#"},"More"),style:{width:"350px"}},w.a.createElement("div",null,w.a.createElement("div",null,w.a.createElement("span",{style:{fontSize:"20px"}},"CPU \u5229\u7528\u7387"),w.a.createElement(o["a"],{percent:null===(a=U[e.id])||void 0===a?void 0:a.cup_used,size:"big",status:"active"})),w.a.createElement("div",null,w.a.createElement("span",{style:{fontSize:"20px"}},"\u5185\u5b58\u4f7f\u7528\u7387"),w.a.createElement(o["a"],{percent:(null===(n=U[e.id])||void 0===n?void 0:n.memory_percent)||e.memory_usage,size:"big",status:"active"})),w.a.createElement("div",null,w.a.createElement("span",{style:{fontSize:"20px"}},"\u5185\u5b58\u4f7f\u7528\u60c5\u51b5:     "),w.a.createElement("span",{style:{fontSize:"20px"}},null===(l=U[e.id])||void 0===l?void 0:l.used_memory," MB / ",((null===(r=U[e.id])||void 0===r?void 0:r.total_memory)/1024).toFixed(2)," GB")))))))}),0===d.filter(e=>"\u5728\u7ebf"===e.tags[0]).length&&w.a.createElement(i["a"],{span:24},w.a.createElement(c["a"],null))))),w.a.createElement(_["a"],{collapsible:"icon",defaultActiveKey:["1"],ghost:!0},w.a.createElement(T,{header:w.a.createElement("div",{style:{fontSize:"20px",fontWeight:"bold"}},"\u5206\u5e03\u5f0f\u7b56\u7565\u751f\u6210"),key:"1"},w.a.createElement("div",{style:{marginTop:"10px",display:"flex",justifyContent:"center",marginLeft:"10px",paddingLeft:"60px"}},w.a.createElement("div",{style:{marginRight:"100px",boxShadow:"5px 5px 10px rgba(0.1, 0.1, 0.1, 0.1)",padding:"20px"}},w.a.createElement(k["default"],{setSelectedTasks:R})),w.a.createElement("div",{style:{boxShadow:"5px 5px 10px rgba(0.1, 0.1, 0.1, 0.1)",padding:"20px"}},w.a.createElement(S["default"],{setSelectedDevices:W}))),w.a.createElement("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"}},Y&&w.a.createElement("button",{className:N.a.button,onClick:ae},"\u751f\u6210\u7b56\u7565"),!Y&&!X&&w.a.createElement("div",{className:N.a.boxes,style:{marginTop:"20px"}},w.a.createElement("div",{class:"box"},w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null)),w.a.createElement("div",{className:N.a.box},w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null)),w.a.createElement("div",{className:N.a.box},w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null)),w.a.createElement("div",{className:N.a.box},w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null),w.a.createElement("div",null))),!Y&&X&&w.a.createElement("div",null,w.a.createElement("div",{className:N.a.singleArrow,style:{marginLeft:"160px"}}),w.a.createElement("div",{style:{marginTop:"30px"}},w.a.createElement(l["a"],{columns:C,dataSource:O})))))))};t["default"]=Object(y["o"])(q)},m5wo:function(e,t,a){e.exports={spinner:"spinner___1gAq3","spinner-fzua35":"spinner-fzua35___SzX2H",card:"card___1q-r6",button:"button___IWTYN",boxes:"boxes___FN6Jd",box:"box___34wzG",box1:"box1___1hgAl",box2:"box2___1CwJ0",box3:"box3___257QR",box4:"box4___1EpDZ",card2:"card2___1o6c0",singleArrow:"singleArrow___1pUKM"}}}]);